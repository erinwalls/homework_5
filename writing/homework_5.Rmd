---
title: "Homework 5"
author: "Erin Walls"
date: "11/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup_1}
list.files("../data/")
```

```{r read_data}
library(tidyverse)
library(readr)

homicides <- read_csv("../data/homicide-data.csv")
```

```{r subset_data}
library(magrittr)

baltimore <- homicides %>% 
  filter(city == "Baltimore")
```

```{r dates}
library(lubridate)

baltimore_1 <- baltimore %>% 
  mutate(reported_date = ymd(reported_date))
```

```{r group_by_month}
baltimore_2 <- baltimore_1 %>% 
  group_by(date = floor_date(reported_date, "month"))

baltimore_3 <- baltimore_2 %>% 
  count(date)
```

```{r freddie_gray}
freddie <- baltimore_2 %>% 
  filter(victim_last == "GREY")
```

```{r graph, fig.width = 10, fig.height = 2}
library(ggplot2)
library(ggthemes)

ggplot(data = baltimore_3) +
  geom_col(mapping = aes(x = date, y = n)) +
  geom_smooth(mapping = aes(x = date, y = n), span = 0.1) +
  geom_vline(data = freddie, mapping = aes(xintercept = date), linetype = "dashed", color = "red", size = 1.5)
```
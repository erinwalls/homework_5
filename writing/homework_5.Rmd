---
title: "Homework 5"
author: "Erin Walls"
date: "11/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup_1}
list.files("../data/")
```

```{r read_data}
library(tidyverse)
library(readr)

homicides <- read_csv("../data/homicide-data.csv")
```

```{r subset_data}
library(magrittr)

baltimore <- homicides %>% 
  filter(city == "Baltimore")
```

```{r dates}
library(lubridate)

baltimore_1 <- baltimore %>% 
  mutate(reported_date = ymd(reported_date))
```

```{r group_by_month}
baltimore_2 <- baltimore_1 %>% 
  group_by(date = floor_date(reported_date, "month"))

baltimore_3 <- baltimore_2 %>% 
  count(date)
```

```{r freddie_gray}
freddie <- baltimore_2 %>% 
  filter(victim_last == "GREY")
```

```{r seasons}
baltimore_4 <- baltimore_1 %>% 
  group_by(date = floor_date(reported_date, "month")) %>% 
  mutate(month = month(date))

summer <- baltimore_4 %>% 
  filter(month %in% c(5, 6, 7, 8, 9, 10)) %>% 
  count(date)

winter <- baltimore_4 %>% 
  filter(month %in% c(1, 2, 3, 4, 11, 12)) %>% 
  count(date)
```

```{r graph, fig.width = 10, fig.height = 2}
library(ggplot2)
library(ggthemes)

ggplot() +
  geom_col(data = summer, mapping = aes(x = date, y = n), fill = "seashell3") +
  geom_col(data = winter, mapping = aes(x = date, y = n), fill = "slategray2") +
  geom_smooth(data = baltimore_3, mapping = aes(x = date, y = n), span = 0.1) +
  geom_vline(data = freddie, mapping = aes(xintercept = date), 
             linetype = "dashed", color = "red", size = 1.5) +
  geom_text(data = freddie, mapping = aes(x = date, y = 0, 
            label = "Arrest of Freddie Gray"), size = 4, vjust = -8.0,
            hjust = 1.0)
  
```